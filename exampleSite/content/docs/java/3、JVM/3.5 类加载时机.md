---
weight: 115
---

# 类加载时机

## 1 类的初始化触发的情况

* 当虚拟机启动时，初始化用户指定的主类，就是启动执行的`main`方法所在的类。
* 当遇到用以新建目标类实例的`new`指令时，初始化`new`指令的目标类，就是`new`一个类的时候要初始化。
* 当遇到调用静态方法的指令时，初始化该静态方法所在的类。
* 当遇到访问静态字段的指令时，初始化该静态字段所在的类。
* 子类的初始化会触发父类的初始化。
* 如果一个接口定义了`default`方法，那么直接实现或者间接实现该接口的类的初始化，会触发该接口的初始化。
* 使用反射API对某个类进行反射调用时，初始化这个类，其实跟前面一样，反射调用要么是已经有实例了，要么是静态方法，都需要初始化。
* 当初次调用`MethodHandle`实例时，初始化该`MethodHandle`指向的方法所在的类。

## 2 不会指定类初始化的情况

* 通过子类引用父类的静态字段，只会触发父类的初始化，而不会触发子类的初始化。
* 定义对象数组，不会触发该类的初始化。
* 常量在编译期间会存入调用类的常量池中，本质上没有直接引用常量的类，不会触发定义常量所在的类。
* 通过类名获取Class对象，不会触发类的初始化，`Hello.class`不会让`Hello`类初始化。
* 通过`ClassLoader`默认的`loadClass`方法，也不会触发初始化动作（加载了，但是不初始化）。
